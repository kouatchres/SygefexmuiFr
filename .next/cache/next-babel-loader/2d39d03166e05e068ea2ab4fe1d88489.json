{"ast":null,"code":"import _regeneratorRuntime from \"E:/sygefexMui/sygefexMui-frontend/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"E:/sygefexMui/sygefexMui-frontend/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"E:/sygefexMui/sygefexMui-frontend/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _slicedToArray from \"E:/sygefexMui/sygefexMui-frontend/node_modules/next/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"E:\\\\sygefexMui\\\\sygefexMui-frontend\\\\src\\\\components\\\\subjectSpecialty\\\\NewSubjDistro.jsx\",\n    _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React from \"react\";\nimport { useMutation, useQuery } from \"@apollo/react-hooks\";\nimport { MinimStyledPage } from \"../styles/StyledPage\";\nimport Error from \"../ErrorMessage.js\";\nimport { Formik, Form } from \"formik\";\nimport { SygefexSelect, SygexInput, StyledForm, ButtonStyled, StyledButton } from \"../utils/FormInputs\";\nimport styled from \"styled-components\";\nimport useForm from \"../utils/useForm\";\nimport * as Yup from \"yup\";\nimport { registerNewSubjectSpecialtyMutation } from \"../queries&Mutations&Functions/Mutations\";\nimport { removeTypename } from \"../queries&Mutations&Functions/Functions\";\nimport { getAllEducationTypesQuery, getAllSubjectsOfAnEducTypeQuery, getAllSpecialtiesOfAnEducationTypeQuery } from \"../queries&Mutations&Functions/Queries\";\nvar InputGroup = styled.div.withConfig({\n  displayName: \"NewSubjDistro__InputGroup\",\n  componentId: \"o1hf48-0\"\n})([\"display:flex;flex-direction:column;margin:0 1rem;\"]);\n_c = InputGroup;\nvar AllControls = styled.div.withConfig({\n  displayName: \"NewSubjDistro__AllControls\",\n  componentId: \"o1hf48-1\"\n})([\"display:flex;flex-direction:column;\"]);\n_c2 = AllControls;\nvar validationSchema = Yup.object().shape({\n  specialty: Yup.string().required(\"Choix de la Série Obligatoire\"),\n  subject: Yup.string().required(\"Choix de la matière Obligatoire\"),\n  coeff: Yup.number().min(1, \"Le coefficient doit etre au moins 1\").required(\"Choix de la matière Obligatoire\")\n});\n\nvar SpecialtyTakesSubjects = function SpecialtyTakesSubjects() {\n  _s();\n\n  var makeSpecialtyObject = function makeSpecialtyObject(specialtyID, specialtyCode) {\n    var storedSpecialty = {\n      id: \"\".concat(specialtyID),\n      specialtyCode: \"\".concat(specialtyCode)\n    };\n    return storedSpecialty;\n  };\n\n  var makeSubjectObject = function makeSubjectObject(subjectID, subjectCode) {\n    var storedSubject = {\n      id: \"\".concat(subjectID),\n      subjectCode: \"\".concat(subjectCode)\n    };\n    return storedSubject;\n  };\n\n  var initialValues = {\n    specialty: \" \",\n    subject: \" \",\n    coeff: \"\"\n  };\n\n  var _useForm = useForm({\n    educTypeID: \" \"\n  }),\n      _useForm2 = _slicedToArray(_useForm, 3),\n      state = _useForm2[0],\n      setState = _useForm2[1],\n      handleReactSelectChange = _useForm2[2];\n\n  var _useQuery = useQuery(getAllEducationTypesQuery),\n      dataEducType = _useQuery.data,\n      loadingEducType = _useQuery.loadingEducType,\n      errorEducType = _useQuery.errorEducType;\n\n  console.log(dataEducType);\n  var getEducTypes = dataEducType && dataEducType.educationTypes;\n  console.log(getEducTypes);\n  var getEducTypeOptions = getEducTypes && getEducTypes.map(function (item) {\n    return {\n      value: item.id,\n      label: item.educationTypeName\n    };\n  });\n\n  var _useQuery2 = useQuery(getAllSpecialtiesOfAnEducationTypeQuery, {\n    skip: !state.educTypeID,\n    variables: {\n      id: state.educTypeID\n    }\n  }),\n      dataSpecialty = _useQuery2.data,\n      loadingSpecialty = _useQuery2.loading,\n      errorSpecialty = _useQuery2.error;\n\n  console.log(dataSpecialty);\n  var getSpecialtyEducType = dataSpecialty && dataSpecialty.educationType;\n\n  var _getSpecialtyEducType = _objectSpread({}, getSpecialtyEducType),\n      specialty = _getSpecialtyEducType.specialty;\n\n  console.log(specialty);\n  var refinedSpecialty = specialty && removeTypename(specialty);\n  var getSpecialtyOptions = refinedSpecialty && refinedSpecialty.map(function (item) {\n    return _objectSpread(_objectSpread({}, item), {}, {\n      value: item.id,\n      label: item.specialtyName\n    });\n  });\n\n  var _useQuery3 = useQuery(getAllSubjectsOfAnEducTypeQuery, {\n    skip: !state.educTypeID,\n    variables: {\n      id: state.educTypeID\n    }\n  }),\n      dataSubj = _useQuery3.data,\n      loadingSubj = _useQuery3.loading,\n      errorSubj = _useQuery3.error;\n\n  console.log(dataSubj);\n  var getEducationType = dataSubj && dataSubj.educationType;\n\n  var _getEducationType = _objectSpread({}, getEducationType),\n      subject = _getEducationType.subject;\n\n  console.log(subject);\n  var refinedSubject = subject && removeTypename(subject);\n  var getSubjectOptions = refinedSubject && refinedSubject.map(function (item) {\n    return {\n      value: item.id,\n      label: item.subjectName\n    };\n  });\n\n  var _useMutation = useMutation(registerNewSubjectSpecialtyMutation),\n      _useMutation2 = _slicedToArray(_useMutation, 2),\n      createSubjectSpecialty = _useMutation2[0],\n      _useMutation2$ = _useMutation2[1],\n      loading = _useMutation2$.loading,\n      error = _useMutation2$.error;\n\n  return __jsx(Formik, {\n    method: \"POST\",\n    initialValues: initialValues,\n    validationSchema: validationSchema,\n    onSubmit: /*#__PURE__*/function () {\n      var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(values, _ref) {\n        var setSubmitting, resetForm, res;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                setSubmitting = _ref.setSubmitting, resetForm = _ref.resetForm;\n                _context.next = 3;\n                return createSubjectSpecialty({\n                  variables: _objectSpread(_objectSpread({}, values), {}, {\n                    specialty: refinedSpecialty && makeSpecialtyObject(values.specialty.value, values.specialty.specialtyCode),\n                    subject: refinedSubject && makeSubjectObject(values.subject.value, values.subject.subjectCode)\n                  })\n                });\n\n              case 3:\n                res = _context.sent;\n                setTimeout(function () {\n                  console.log(JSON.stringify(values, null, 2));\n                  console.log(res);\n                  resetForm(true);\n                  setSubmitting(false);\n                }, 200);\n\n              case 5:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      return function (_x, _x2) {\n        return _ref2.apply(this, arguments);\n      };\n    }(),\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 5\n    }\n  }, function (_ref3) {\n    var values = _ref3.values,\n        isSubmitting = _ref3.isSubmitting,\n        setFieldValue = _ref3.setFieldValue;\n    return __jsx(MinimStyledPage, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 165,\n        columnNumber: 11\n      }\n    }, __jsx(\"h4\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 166,\n        columnNumber: 13\n      }\n    }, \"Donner les mati\\xE8res aux Sp\\xE9cialit\\xE9s\"), __jsx(Error, {\n      error: error || errorEducType || errorSpecialty || errorSubj,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 167,\n        columnNumber: 13\n      }\n    }), __jsx(StyledForm, {\n      disabled: isSubmitting || loading || loadingEducType || loadingSpecialty || loadingSubj,\n      \"aria-busy\": isSubmitting || loading || loadingEducType || loadingSpecialty || loadingSubj,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 173,\n        columnNumber: 13\n      }\n    }, __jsx(Form, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 189,\n        columnNumber: 15\n      }\n    }, __jsx(AllControls, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 190,\n        columnNumber: 17\n      }\n    }, __jsx(InputGroup, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 191,\n        columnNumber: 19\n      }\n    }, __jsx(SygefexSelect, {\n      onChange: handleReactSelectChange,\n      name: \"educTypeID\",\n      placeholder: \"Le type d'enseignement\",\n      options: getEducTypeOptions,\n      disbled: isSubmitting,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 192,\n        columnNumber: 21\n      }\n    }), __jsx(SygefexSelect, {\n      onChange: function onChange(value) {\n        return setFieldValue(\"specialty\", value);\n      },\n      name: \"specialty\",\n      placeholder: \"La Sp\\xE9cialit\\xE9\",\n      options: getSpecialtyOptions,\n      disbled: isSubmitting,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 199,\n        columnNumber: 21\n      }\n    }), __jsx(SygefexSelect, {\n      onChange: function onChange(value) {\n        return setFieldValue(\"subject\", value);\n      },\n      name: \"subject\",\n      placeholder: \"La mati\\xE8re\",\n      options: getSubjectOptions,\n      disbled: isSubmitting,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 206,\n        columnNumber: 21\n      }\n    }), __jsx(SygexInput, {\n      name: \"coeff\",\n      type: \"number\",\n      label: \"Coefficient de la mati\\xE8re\",\n      disabled: isSubmitting,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 213,\n        columnNumber: 21\n      }\n    })), __jsx(ButtonStyled, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 220,\n        columnNumber: 19\n      }\n    }, __jsx(StyledButton, {\n      type: \"submit\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 221,\n        columnNumber: 21\n      }\n    }, \"Valid\", isSubmitting ? \"ation en cours\" : \"er\"))))));\n  });\n};\n\n_s(SpecialtyTakesSubjects, \"XvVKNYJqCh/z2+VMet66klfNT/0=\", false, function () {\n  return [useForm, useQuery, useQuery, useQuery, useMutation];\n});\n\n_c3 = SpecialtyTakesSubjects;\nexport default SpecialtyTakesSubjects;\n\nvar _c, _c2, _c3;\n\n$RefreshReg$(_c, \"InputGroup\");\n$RefreshReg$(_c2, \"AllControls\");\n$RefreshReg$(_c3, \"SpecialtyTakesSubjects\");","map":{"version":3,"sources":["E:/sygefexMui/sygefexMui-frontend/src/components/subjectSpecialty/NewSubjDistro.jsx"],"names":["React","useMutation","useQuery","MinimStyledPage","Error","Formik","Form","SygefexSelect","SygexInput","StyledForm","ButtonStyled","StyledButton","styled","useForm","Yup","registerNewSubjectSpecialtyMutation","removeTypename","getAllEducationTypesQuery","getAllSubjectsOfAnEducTypeQuery","getAllSpecialtiesOfAnEducationTypeQuery","InputGroup","div","AllControls","validationSchema","object","shape","specialty","string","required","subject","coeff","number","min","SpecialtyTakesSubjects","makeSpecialtyObject","specialtyID","specialtyCode","storedSpecialty","id","makeSubjectObject","subjectID","subjectCode","storedSubject","initialValues","educTypeID","state","setState","handleReactSelectChange","dataEducType","data","loadingEducType","errorEducType","console","log","getEducTypes","educationTypes","getEducTypeOptions","map","item","value","label","educationTypeName","skip","variables","dataSpecialty","loadingSpecialty","loading","errorSpecialty","error","getSpecialtyEducType","educationType","refinedSpecialty","getSpecialtyOptions","specialtyName","dataSubj","loadingSubj","errorSubj","getEducationType","refinedSubject","getSubjectOptions","subjectName","createSubjectSpecialty","values","setSubmitting","resetForm","res","setTimeout","JSON","stringify","isSubmitting","setFieldValue"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport { useMutation, useQuery } from \"@apollo/react-hooks\";\r\nimport { MinimStyledPage } from \"../styles/StyledPage\";\r\nimport Error from \"../ErrorMessage.js\";\r\nimport { Formik, Form } from \"formik\";\r\nimport {\r\n  SygefexSelect,\r\n  SygexInput,\r\n  StyledForm,\r\n  ButtonStyled,\r\n  StyledButton,\r\n} from \"../utils/FormInputs\";\r\nimport styled from \"styled-components\";\r\nimport useForm from \"../utils/useForm\";\r\nimport * as Yup from \"yup\";\r\nimport { registerNewSubjectSpecialtyMutation } from \"../queries&Mutations&Functions/Mutations\";\r\nimport { removeTypename } from \"../queries&Mutations&Functions/Functions\";\r\nimport {\r\n  getAllEducationTypesQuery,\r\n  getAllSubjectsOfAnEducTypeQuery,\r\n  getAllSpecialtiesOfAnEducationTypeQuery,\r\n} from \"../queries&Mutations&Functions/Queries\";\r\n\r\nconst InputGroup = styled.div`\r\n  display: flex;\r\n  flex-direction: column;\r\n  margin: 0 1rem;\r\n`;\r\n\r\nconst AllControls = styled.div`\r\n  display: flex;\r\n  flex-direction: column;\r\n`;\r\n\r\nconst validationSchema = Yup.object().shape({\r\n  specialty: Yup.string().required(\"Choix de la Série Obligatoire\"),\r\n  subject: Yup.string().required(\"Choix de la matière Obligatoire\"),\r\n  coeff: Yup.number()\r\n    .min(1, \"Le coefficient doit etre au moins 1\")\r\n    .required(\"Choix de la matière Obligatoire\"),\r\n});\r\n\r\nconst SpecialtyTakesSubjects = () => {\r\n  const makeSpecialtyObject = (specialtyID, specialtyCode) => {\r\n    const storedSpecialty = {\r\n      id: `${specialtyID}`,\r\n      specialtyCode: `${specialtyCode}`,\r\n    };\r\n    return storedSpecialty;\r\n  };\r\n\r\n  const makeSubjectObject = (subjectID, subjectCode) => {\r\n    const storedSubject = {\r\n      id: `${subjectID}`,\r\n      subjectCode: `${subjectCode}`,\r\n    };\r\n    return storedSubject;\r\n  };\r\n  const initialValues = {\r\n    specialty: \" \",\r\n    subject: \" \",\r\n    coeff: \"\",\r\n  };\r\n\r\n  const [state, setState, handleReactSelectChange] = useForm({\r\n    educTypeID: \" \",\r\n  });\r\n\r\n \r\n  const { data: dataEducType, loadingEducType, errorEducType } = useQuery(\r\n    getAllEducationTypesQuery\r\n  );\r\n  \r\n  console.log(dataEducType);\r\n\r\n  const getEducTypes = dataEducType && dataEducType.educationTypes;\r\n  console.log(getEducTypes);\r\n  const getEducTypeOptions =\r\n    getEducTypes &&\r\n    getEducTypes.map((item) => ({\r\n      value: item.id,\r\n      label: item.educationTypeName,\r\n    }));\r\n\r\n  const {\r\n    data: dataSpecialty,\r\n    loading: loadingSpecialty,\r\n    error: errorSpecialty,\r\n  } = useQuery(getAllSpecialtiesOfAnEducationTypeQuery, {\r\n    skip: !state.educTypeID,\r\n    variables: { id: state.educTypeID },\r\n  });\r\n  \r\n  console.log(dataSpecialty);\r\n\r\n  const getSpecialtyEducType = dataSpecialty && dataSpecialty.educationType;\r\n  const { specialty } = { ...getSpecialtyEducType };\r\n  console.log(specialty);\r\n\r\n  const refinedSpecialty = specialty && removeTypename(specialty);\r\n  const getSpecialtyOptions =\r\n    refinedSpecialty &&\r\n    refinedSpecialty.map((item) => ({\r\n      ...item,\r\n      value: item.id,\r\n      label: item.specialtyName,\r\n    }));\r\n\r\n  const { data: dataSubj, loading: loadingSubj, error: errorSubj } = useQuery(\r\n    getAllSubjectsOfAnEducTypeQuery,\r\n    {\r\n      skip: !state.educTypeID,\r\n      variables: { id: state.educTypeID },\r\n    }\r\n  );\r\n  \r\n  console.log(dataSubj);\r\n  const getEducationType = dataSubj && dataSubj.educationType;\r\n  const { subject } = { ...getEducationType };\r\n  console.log(subject);\r\n  const refinedSubject = subject && removeTypename(subject);\r\n  const getSubjectOptions =\r\n    refinedSubject &&\r\n    refinedSubject.map((item) => ({\r\n      value: item.id,\r\n      label: item.subjectName,\r\n    }));\r\n\r\n  const [createSubjectSpecialty, { loading, error }] = useMutation(\r\n    registerNewSubjectSpecialtyMutation\r\n  );\r\n  return (\r\n    <Formik\r\n      method=\"POST\"\r\n      initialValues={initialValues}\r\n      validationSchema={validationSchema}\r\n      onSubmit={async (values, { setSubmitting, resetForm }) => {\r\n        const res = await createSubjectSpecialty({\r\n          variables: {\r\n            ...values,\r\n            specialty:\r\n              refinedSpecialty &&\r\n              makeSpecialtyObject(\r\n                values.specialty.value,\r\n                values.specialty.specialtyCode\r\n              ),\r\n            subject:\r\n              refinedSubject &&\r\n              makeSubjectObject(\r\n                values.subject.value,\r\n                values.subject.subjectCode\r\n              ),\r\n          },\r\n        });\r\n        setTimeout(() => {\r\n          console.log(JSON.stringify(values, null, 2));\r\n          console.log(res);\r\n          resetForm(true);\r\n          setSubmitting(false);\r\n        }, 200);\r\n      }}\r\n    >\r\n      {({ values, isSubmitting, setFieldValue }) => {\r\n        return (\r\n          <MinimStyledPage>\r\n            <h4>Donner les matières aux Spécialités</h4>\r\n            <Error error={\r\n              error ||\r\n              errorEducType||\r\nerrorSpecialty||\r\nerrorSubj } />\r\n          \r\n            <StyledForm\r\n              disabled={\r\n                isSubmitting ||\r\n                loading ||\r\n                loadingEducType ||\r\n                loadingSpecialty ||\r\n                loadingSubj\r\n              }\r\n              aria-busy={\r\n                isSubmitting ||\r\n                loading ||\r\n                loadingEducType ||\r\n                loadingSpecialty ||\r\n                loadingSubj\r\n              }\r\n            >\r\n              <Form>\r\n                <AllControls>\r\n                  <InputGroup>\r\n                    <SygefexSelect\r\n                      onChange={handleReactSelectChange}\r\n                      name=\"educTypeID\"\r\n                      placeholder=\"Le type d'enseignement\"\r\n                      options={getEducTypeOptions}\r\n                      disbled={isSubmitting}\r\n                    />\r\n                    <SygefexSelect\r\n                      onChange={(value) => setFieldValue(\"specialty\", value)}\r\n                      name=\"specialty\"\r\n                      placeholder=\"La Spécialité\"\r\n                      options={getSpecialtyOptions}\r\n                      disbled={isSubmitting}\r\n                    />\r\n                    <SygefexSelect\r\n                      onChange={(value) => setFieldValue(\"subject\", value)}\r\n                      name=\"subject\"\r\n                      placeholder=\"La matière\"\r\n                      options={getSubjectOptions}\r\n                      disbled={isSubmitting}\r\n                    />\r\n                    <SygexInput\r\n                      name=\"coeff\"\r\n                      type=\"number\"\r\n                      label=\"Coefficient de la matière\"\r\n                      disabled={isSubmitting}\r\n                    />\r\n                  </InputGroup>\r\n                  <ButtonStyled>\r\n                    <StyledButton type=\"submit\">\r\n                      Valid{isSubmitting ? \"ation en cours\" : \"er\"}\r\n                    </StyledButton>\r\n                  </ButtonStyled>\r\n                </AllControls>\r\n              </Form>\r\n            </StyledForm>\r\n          </MinimStyledPage>\r\n        );\r\n      }}\r\n    </Formik>\r\n  );\r\n};\r\nexport default SpecialtyTakesSubjects;\r\n"]},"metadata":{},"sourceType":"module"}
{"ast":null,"code":"var _jsxFileName = \"E:\\\\sygefexMui\\\\sygefexMui-frontend\\\\src\\\\components\\\\subject\\\\CreateNewSubjectHook.jsx\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React, { useEffect } from \"react\";\nimport { useMutation, useQuery } from \"@apollo/react-hooks\";\nimport { MiniStyledPage } from \"../styles/StyledPage\";\nimport Error from \"../ErrorMessage.js\";\nimport { Formik, Form } from \"formik\";\nimport { SygefexSelect, SygexInput, StyledForm, ButtonStyled, StyledButton } from \"../utils/FormInputs\";\nimport styled from \"styled-components\";\nimport * as Yup from \"yup\";\nimport { getAllEducationTypesQuery } from \"../queries&Mutations&Functions/Queries\";\nimport { createNewSubjectMutation } from \"../queries&Mutations&Functions/Mutations\";\nimport { getObjectFromID, removeTypename } from \"../queries&Mutations&Functions/Functions\";\nimport { FormikRadio } from \"@dccs/react-formik-mui\";\nimport { FormLabel, RadioGroup } from \"@material-ui/core\";\nconst InputGroup = styled.div.withConfig({\n  displayName: \"CreateNewSubjectHook__InputGroup\",\n  componentId: \"sc-1rr1zdn-0\"\n})([\"display:flex;flex-direction:column;margin:0 1rem;\"]);\nconst InputRadioGroup = styled.div.withConfig({\n  displayName: \"CreateNewSubjectHook__InputRadioGroup\",\n  componentId: \"sc-1rr1zdn-1\"\n})([\"display:grid;grid-template-columns:repeat(auto-fit,minmax(15rem,1fr));grid-gap:1rem;\"]);\nconst AllControls = styled.div.withConfig({\n  displayName: \"CreateNewSubjectHook__AllControls\",\n  componentId: \"sc-1rr1zdn-2\"\n})([\"display:flex;flex-direction:column;\"]);\nconst SubjTypeRadioButtons = styled.div.withConfig({\n  displayName: \"CreateNewSubjectHook__SubjTypeRadioButtons\",\n  componentId: \"sc-1rr1zdn-3\"\n})([\"display:flex;padding:0 0.5rem;label{font-size:1.3rem;}flex-direction:column;justify-content:center;.RadioSet{FormikCheckbox{font-size:1.5rem;}padding:0 0.5rem;justify-content:center;display:flex;flex-direction:row;}\"]);\nconst SubjectGroupRadioButtons = styled.div.withConfig({\n  displayName: \"CreateNewSubjectHook__SubjectGroupRadioButtons\",\n  componentId: \"sc-1rr1zdn-4\"\n})([\"display:flex;padding:0 0.5rem;label{font-size:1.3rem;}flex-direction:row;justify-content:center;.RadioSet{FormikRadio{font-size:1.5rem;}padding:0.5rem auto;margin:0.5rem auto;display:flex;flex-direction:row;justify-content:center;label{font-size:1.3rem;}}\"]);\nconst validationSchema = Yup.object().shape({\n  subjectName: Yup.string().required(\"Libéllé de la matière obligatoire\"),\n  subjectCode: Yup.string().required(\"Code de la matière obligatoire\"),\n  subjectGroup: Yup.string().required(\"Groupe de la matière obligatoire\"),\n  subjectType: Yup.string().required(\"Type de la matière obligatoire\"),\n  educType: Yup.string().required(\"Choix d'un type d'enseignement obligatiore\")\n});\n\nconst CreateNewSubject = () => {\n  const initialValues = {\n    subjectName: \"\",\n    subjectCode: \"\",\n    educType: \"\",\n    subjectType: \"autre\",\n    subjectGroup: \"G3\"\n  };\n\n  const facObligCheck = () => {\n    if (document.getElementById(\"facChoice\").checked) {\n      document.getElementById(\"groupButtons\").style.display = \"block\";\n    } else if (document.getElementById(\"autres\").checked) {\n      document.getElementById(\"groupButtons\").style.display = \"none\";\n    }\n  };\n\n  useEffect(() => {\n    document.getElementById(\"groupButtons\").style.display = \"none\";\n  }, []);\n  const {\n    data: dataEducType,\n    loading: loadingEducType,\n    error: errorEducType\n  } = useQuery(getAllEducationTypesQuery);\n  const getEducationTypes = dataEducType && dataEducType.educationTypes;\n  const refinedEducTypes = getEducationTypes && removeTypename(getEducationTypes);\n  const getEducTypeOptions = refinedEducTypes && refinedEducTypes.map(item => ({\n    value: item.id,\n    label: item.educationTypeName\n  }));\n  const [createSubject, {\n    loadingSubj,\n    errorSubj\n  }] = useMutation(createNewSubjectMutation);\n  return __jsx(Formik, {\n    method: \"POST\",\n    initialValues: initialValues,\n    validationSchema: validationSchema,\n    onSubmit: async (values, {\n      setSubmitting,\n      resetForm\n    }) => {\n      const res = await createSubject({\n        variables: _objectSpread(_objectSpread({}, values), {}, {\n          educType: refinedEducTypes && getObjectFromID(values.educType.value)\n        })\n      });\n      setTimeout(() => {\n        console.log(JSON.stringify(values, null, 2));\n        console.log(res);\n        setSubmitting(false);\n        resetForm(true);\n      }, 400);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 5\n    }\n  }, ({\n    values,\n    setFieldValue,\n    isSubmitting\n  }) => {\n    return __jsx(MiniStyledPage, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 159,\n        columnNumber: 11\n      }\n    }, __jsx(\"h4\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 160,\n        columnNumber: 13\n      }\n    }, \"Nouvelle Mati\\xE8re\"), __jsx(Error, {\n      error: errorSubj || errorEducType || errorSubj,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 161,\n        columnNumber: 13\n      }\n    }), __jsx(StyledForm, {\n      disabled: isSubmitting || loadingEducType || loadingSubj,\n      \"aria-busy\": isSubmitting || loadingEducType || loadingSubj,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 162,\n        columnNumber: 13\n      }\n    }, __jsx(Form, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 166,\n        columnNumber: 15\n      }\n    }, __jsx(AllControls, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 167,\n        columnNumber: 17\n      }\n    }, __jsx(InputGroup, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168,\n        columnNumber: 19\n      }\n    }, __jsx(SygefexSelect, {\n      name: \"educType\",\n      onChange: value => setFieldValue(\"educType\", value),\n      options: getEducTypeOptions,\n      placeholder: \"Le Type d'Enseignement\",\n      disabled: isSubmitting,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 169,\n        columnNumber: 21\n      }\n    }), __jsx(SygexInput, {\n      name: \"subjectName\",\n      type: \"text\",\n      label: \"Lib\\xE9ll\\xE9 de la Mati\\xE8re\",\n      disabled: isSubmitting,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 176,\n        columnNumber: 21\n      }\n    }), __jsx(SygexInput, {\n      name: \"subjectCode\",\n      type: \"text\",\n      label: \"Code de la Mati\\xE8re\",\n      disabled: isSubmitting,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 182,\n        columnNumber: 21\n      }\n    })), __jsx(InputRadioGroup, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 189,\n        columnNumber: 19\n      }\n    }, __jsx(SubjTypeRadioButtons, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 190,\n        columnNumber: 21\n      }\n    }, __jsx(FormLabel, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 191,\n        columnNumber: 23\n      }\n    }, \"Type Mati\\xE8re\"), __jsx(RadioGroup, {\n      className: \"RadioSet\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 192,\n        columnNumber: 23\n      }\n    }, __jsx(FormikRadio, {\n      id: \"autres\",\n      label: \"Autres\",\n      name: \"subjectType\",\n      value: \"Obligatoire\",\n      checked: true,\n      onClick: facObligCheck,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 193,\n        columnNumber: 25\n      }\n    }), __jsx(FormikRadio, {\n      label: \"Facultative\",\n      name: \"subjectType\",\n      value: \"Facultative\",\n      id: \"facChoice\",\n      onClick: facObligCheck,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 201,\n        columnNumber: 25\n      }\n    }))), __jsx(SubjectGroupRadioButtons, {\n      id: \"groupButtons\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 210,\n        columnNumber: 21\n      }\n    }, __jsx(FormLabel, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 211,\n        columnNumber: 23\n      }\n    }, \"Groupe Epreuve\"), __jsx(RadioGroup, {\n      className: \"RadioSet\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 212,\n        columnNumber: 23\n      }\n    }, __jsx(FormikRadio, {\n      label: \"EPF 1\",\n      name: \"subjectGroup\",\n      value: \"EPF1\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 213,\n        columnNumber: 25\n      }\n    }), __jsx(FormikRadio, {\n      label: \"EPF 2\",\n      name: \"subjectGroup\",\n      value: \"EPF2\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 218,\n        columnNumber: 25\n      }\n    })))), __jsx(ButtonStyled, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 226,\n        columnNumber: 19\n      }\n    }, __jsx(StyledButton, {\n      type: \"submit\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 227,\n        columnNumber: 21\n      }\n    }, \"Valid\", isSubmitting ? \"ation en cours\" : \"er\"))))));\n  });\n};\n\nexport default CreateNewSubject;","map":{"version":3,"sources":["E:/sygefexMui/sygefexMui-frontend/src/components/subject/CreateNewSubjectHook.jsx"],"names":["React","useEffect","useMutation","useQuery","MiniStyledPage","Error","Formik","Form","SygefexSelect","SygexInput","StyledForm","ButtonStyled","StyledButton","styled","Yup","getAllEducationTypesQuery","createNewSubjectMutation","getObjectFromID","removeTypename","FormikRadio","FormLabel","RadioGroup","InputGroup","div","InputRadioGroup","AllControls","SubjTypeRadioButtons","SubjectGroupRadioButtons","validationSchema","object","shape","subjectName","string","required","subjectCode","subjectGroup","subjectType","educType","CreateNewSubject","initialValues","facObligCheck","document","getElementById","checked","style","display","data","dataEducType","loading","loadingEducType","error","errorEducType","getEducationTypes","educationTypes","refinedEducTypes","getEducTypeOptions","map","item","value","id","label","educationTypeName","createSubject","loadingSubj","errorSubj","values","setSubmitting","resetForm","res","variables","setTimeout","console","log","JSON","stringify","setFieldValue","isSubmitting"],"mappings":"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","sourcesContent":["import React, { useEffect } from \"react\";\r\nimport { useMutation, useQuery } from \"@apollo/react-hooks\";\r\nimport { MiniStyledPage } from \"../styles/StyledPage\";\r\nimport Error from \"../ErrorMessage.js\";\r\nimport { Formik, Form } from \"formik\";\r\nimport {\r\n  SygefexSelect,\r\n  SygexInput,\r\n  StyledForm,\r\n  ButtonStyled,\r\n  StyledButton,\r\n} from \"../utils/FormInputs\";\r\nimport styled from \"styled-components\";\r\nimport * as Yup from \"yup\";\r\nimport { getAllEducationTypesQuery } from \"../queries&Mutations&Functions/Queries\";\r\nimport { createNewSubjectMutation } from \"../queries&Mutations&Functions/Mutations\";\r\nimport {\r\n  getObjectFromID,\r\n  removeTypename,\r\n} from \"../queries&Mutations&Functions/Functions\";\r\nimport {\r\n  FormikRadio\r\n} from \"@dccs/react-formik-mui\";\r\nimport { FormLabel, RadioGroup } from \"@material-ui/core\";\r\n\r\nconst InputGroup = styled.div`\r\n  display: flex;\r\n  flex-direction: column;\r\n  margin: 0 1rem;\r\n`;\r\n\r\nconst InputRadioGroup = styled.div`\r\n  display: grid;\r\n  grid-template-columns: repeat(auto-fit, minmax(15rem, 1fr));\r\n  grid-gap: 1rem;\r\n`;\r\nconst AllControls = styled.div`\r\n  display: flex;\r\n  flex-direction: column;\r\n`;\r\n\r\nconst SubjTypeRadioButtons = styled.div`\r\n  display: flex;\r\n  padding: 0 0.5rem;\r\n  label {\r\n    font-size: 1.3rem;\r\n  }\r\n\r\n  flex-direction: column;\r\n  justify-content: center;\r\n  .RadioSet {\r\n    FormikCheckbox {\r\n      font-size: 1.5rem;\r\n    }\r\n    padding: 0 0.5rem;\r\n\r\n    justify-content: center;\r\n    display: flex;\r\n    flex-direction: row;\r\n  }\r\n`;\r\n\r\nconst SubjectGroupRadioButtons = styled.div`\r\n  display: flex;\r\n  padding: 0 0.5rem;\r\n  label {\r\n    font-size: 1.3rem;\r\n  }\r\n\r\n  flex-direction: row;\r\n  justify-content: center;\r\n  .RadioSet {\r\n    FormikRadio {\r\n      font-size: 1.5rem;\r\n    }\r\n    padding: 0.5rem auto;\r\n    margin: 0.5rem auto;\r\n\r\n    display: flex;\r\n    flex-direction: row;\r\n    justify-content: center;\r\n    label {\r\n      font-size: 1.3rem;\r\n    }\r\n  }\r\n`;\r\n\r\nconst validationSchema = Yup.object().shape({\r\n  subjectName: Yup.string().required(\"Libéllé de la matière obligatoire\"),\r\n  subjectCode: Yup.string().required(\"Code de la matière obligatoire\"),\r\n  subjectGroup: Yup.string().required(\"Groupe de la matière obligatoire\"),\r\n  subjectType: Yup.string().required(\"Type de la matière obligatoire\"),\r\n  educType: Yup.string().required(\"Choix d'un type d'enseignement obligatiore\"),\r\n});\r\n\r\nconst CreateNewSubject = () => {\r\n  const initialValues = {\r\n    subjectName: \"\",\r\n    subjectCode: \"\",\r\n    educType: \"\",\r\n    subjectType: \"autre\",\r\n    subjectGroup: \"G3\",\r\n  };\r\n\r\n  const facObligCheck = () => {\r\n    if (document.getElementById(\"facChoice\").checked) {\r\n      document.getElementById(\"groupButtons\").style.display = \"block\";\r\n    } else if (document.getElementById(\"autres\").checked) {\r\n      document.getElementById(\"groupButtons\").style.display = \"none\";\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    document.getElementById(\"groupButtons\").style.display = \"none\";\r\n  }, []);\r\n\r\n  const {\r\n    data: dataEducType,\r\n    loading: loadingEducType,\r\n    error: errorEducType,\r\n  } = useQuery(getAllEducationTypesQuery);\r\n\r\n  const getEducationTypes = dataEducType && dataEducType.educationTypes;\r\n  const refinedEducTypes =\r\n    getEducationTypes && removeTypename(getEducationTypes);\r\n  const getEducTypeOptions =\r\n    refinedEducTypes &&\r\n    refinedEducTypes.map((item) => ({\r\n      value: item.id,\r\n      label: item.educationTypeName,\r\n    }));\r\n\r\n  const [createSubject, { loadingSubj, errorSubj }] = useMutation(\r\n    createNewSubjectMutation\r\n  );\r\n  return (\r\n    <Formik\r\n      method=\"POST\"\r\n      initialValues={initialValues}\r\n      validationSchema={validationSchema}\r\n      onSubmit={async (values, { setSubmitting, resetForm }) => {\r\n        const res = await createSubject({\r\n          variables: {\r\n            ...values,\r\n            educType:\r\n              refinedEducTypes && getObjectFromID(values.educType.value),\r\n          },\r\n        });\r\n        setTimeout(() => {\r\n          console.log(JSON.stringify(values, null, 2));\r\n          console.log(res);\r\n          setSubmitting(false);\r\n          resetForm(true);\r\n        }, 400);\r\n      }}\r\n    >\r\n      {({ values, setFieldValue, isSubmitting }) => {\r\n        return (\r\n          <MiniStyledPage>\r\n            <h4>Nouvelle Matière</h4>\r\n            <Error error={errorSubj  ||errorEducType || errorSubj} />\r\n            <StyledForm\r\n              disabled={isSubmitting || loadingEducType || loadingSubj}\r\n              aria-busy={isSubmitting || loadingEducType || loadingSubj}\r\n            >\r\n              <Form>\r\n                <AllControls>\r\n                  <InputGroup>\r\n                    <SygefexSelect\r\n                      name=\"educType\"\r\n                      onChange={(value) => setFieldValue(\"educType\", value)}\r\n                      options={getEducTypeOptions}\r\n                      placeholder={\"Le Type d'Enseignement\"}\r\n                      disabled={isSubmitting}\r\n                    />\r\n                    <SygexInput\r\n                      name=\"subjectName\"\r\n                      type=\"text\"\r\n                      label=\"Libéllé de la Matière\"\r\n                      disabled={isSubmitting}\r\n                    />\r\n                    <SygexInput\r\n                      name=\"subjectCode\"\r\n                      type=\"text\"\r\n                      label=\"Code de la Matière\"\r\n                      disabled={isSubmitting}\r\n                    />\r\n                  </InputGroup>\r\n                  <InputRadioGroup>\r\n                    <SubjTypeRadioButtons>\r\n                      <FormLabel>Type Matière</FormLabel>\r\n                      <RadioGroup className=\"RadioSet\">\r\n                        <FormikRadio\r\n                          id=\"autres\"\r\n                          label=\"Autres\"\r\n                          name=\"subjectType\"\r\n                          value=\"Obligatoire\"\r\n                          checked={true}\r\n                          onClick={facObligCheck}\r\n                        />\r\n                        <FormikRadio\r\n                          label=\"Facultative\"\r\n                          name=\"subjectType\"\r\n                          value=\"Facultative\"\r\n                          id=\"facChoice\"\r\n                          onClick={facObligCheck}\r\n                        />\r\n                      </RadioGroup>\r\n                    </SubjTypeRadioButtons>\r\n                    <SubjectGroupRadioButtons id=\"groupButtons\">\r\n                      <FormLabel>Groupe Epreuve</FormLabel>\r\n                      <RadioGroup className=\"RadioSet\">\r\n                        <FormikRadio\r\n                          label=\"EPF 1\"\r\n                          name=\"subjectGroup\"\r\n                          value=\"EPF1\"\r\n                        />\r\n                        <FormikRadio\r\n                          label=\"EPF 2\"\r\n                          name=\"subjectGroup\"\r\n                          value=\"EPF2\"\r\n                        />\r\n                      </RadioGroup>\r\n                    </SubjectGroupRadioButtons>\r\n                  </InputRadioGroup>\r\n                  <ButtonStyled>\r\n                    <StyledButton type=\"submit\">\r\n                      Valid{isSubmitting ? \"ation en cours\" : \"er\"}\r\n                    </StyledButton>\r\n                  </ButtonStyled>\r\n                </AllControls>\r\n              </Form>\r\n            </StyledForm>\r\n          </MiniStyledPage>\r\n        );\r\n      }}\r\n    </Formik>\r\n  );\r\n};\r\nexport default CreateNewSubject;\r\n"]},"metadata":{},"sourceType":"module"}
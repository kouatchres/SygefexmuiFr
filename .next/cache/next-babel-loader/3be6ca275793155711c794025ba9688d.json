{"ast":null,"code":"import _regeneratorRuntime from \"E:/sygefexMui/sygefexMui-frontend/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"E:/sygefexMui/sygefexMui-frontend/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"E:/sygefexMui/sygefexMui-frontend/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _slicedToArray from \"E:/sygefexMui/sygefexMui-frontend/node_modules/next/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"E:\\\\sygefexMui\\\\sygefexMui-frontend\\\\src\\\\components\\\\center\\\\UpdateCenter.jsx\",\n    _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useEffect } from 'react';\nimport { useMutation, useApolloClient } from '@apollo/react-hooks';\nimport { MiniStyledPage } from '../styles/StyledPage';\nimport Error from '../ErrorMessage';\nimport { Formik, Form } from 'formik';\nimport useForm from '../utils/useForm';\nimport Router from 'next/router';\nimport * as Yup from 'yup';\nimport { SygexInput, StyledForm, StyledButton, ButtonStyled } from '../utils/FormInputs';\nimport { singleCenterQuery } from \"../queries&Mutations&Functions/Queries\";\nimport { updateCenterMutation } from \"../queries&Mutations&Functions/Mutations\";\nimport styled from 'styled-components';\nvar Controls = styled.div.withConfig({\n  displayName: \"UpdateCenter__Controls\",\n  componentId: \"hg34ox-0\"\n})([\"padding:0 2rem;\"]);\n_c = Controls;\n\nvar UpdateCenter = function UpdateCenter(_ref) {\n  _s();\n\n  var id = _ref.id;\n  var client = useApolloClient();\n\n  var _useForm = useForm({\n    centerCode: \"\",\n    centerName: \"\",\n    centerNumber: \"\"\n  }),\n      _useForm2 = _slicedToArray(_useForm, 2),\n      state = _useForm2[0],\n      setState = _useForm2[1];\n\n  var _useState = useState({\n    isOpen: false,\n    message: \"\",\n    type: \"\"\n  }),\n      _useState2 = _slicedToArray(_useState, 2),\n      notify = _useState2[0],\n      setNotify = _useState2[1];\n\n  var handleChange = function handleChange(e) {\n    var _e$target = e.target,\n        name = _e$target.name,\n        value = _e$target.value,\n        type = _e$target.type;\n    var val = type === \"number\" ? parseFloat(value) : value;\n    setState(_defineProperty({}, name, val));\n  };\n\n  var updateSingleCenter = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(e, updateMutation) {\n      var res;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              e.preventDefault();\n              _context.next = 3;\n              return updateMutation({\n                variables: _objectSpread({\n                  id: id\n                }, state)\n              });\n\n            case 3:\n              res = _context.sent;\n\n            case 4:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function updateSingleCenter(_x, _x2) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var loadCenterData = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      var _yield$client$query, error, data, centerData, centerCode, centerName, centerNumber;\n\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return client.query({\n                query: singleCenterQuery,\n                variables: {\n                  id: id\n                }\n              });\n\n            case 2:\n              _yield$client$query = _context2.sent;\n              error = _yield$client$query.error;\n              data = _yield$client$query.data;\n              error && __jsx(Error, {\n                error: error,\n                __self: _this,\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 54,\n                  columnNumber: 15\n                }\n              });\n              centerData = _objectSpread({}, data.center);\n              centerCode = centerData.centerCode, centerName = centerData.centerName, centerNumber = centerData.centerNumber;\n              setState({\n                centerCode: centerCode,\n                centerName: centerName,\n                centerNumber: centerNumber\n              });\n              console.log(centerData);\n\n            case 10:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function loadCenterData() {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  useEffect(function () {\n    loadCenterData();\n  }, []);\n  var initialValues = {\n    centerCode: \"\",\n    centerName: \"\",\n    centerNumber: \"\"\n  };\n  var validationSchema = Yup.object().shape({\n    centerName: Yup.string().required('Libellé du centre obligatoire'),\n    centerCode: Yup.string().required('Code du centre  obligatoire'),\n    centerNumber: Yup.number().required('Numéro  du centre obligatoire')\n  });\n\n  var _useMutation = useMutation(updateCenterMutation, {\n    variables: {\n      id: id\n    }\n  }),\n      _useMutation2 = _slicedToArray(_useMutation, 2),\n      updateCenter = _useMutation2[0],\n      _useMutation2$ = _useMutation2[1],\n      loadingMut = _useMutation2$.loading,\n      errorMut = _useMutation2$.error;\n\n  return __jsx(Formik, {\n    method: \"POST\",\n    initialValues: state || initialValues,\n    enableReinitialize: true,\n    validationSchema: validationSchema,\n    onSubmit: /*#__PURE__*/function () {\n      var _ref5 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(values, _ref4) {\n        var resetForm, setSubmitting, res;\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                resetForm = _ref4.resetForm, setSubmitting = _ref4.setSubmitting;\n                _context3.next = 3;\n                return updateCenter({\n                  variables: _objectSpread(_objectSpread({}, values), {}, {\n                    id: id\n                  })\n                });\n\n              case 3:\n                res = _context3.sent;\n                setTimeout(function () {\n                  console.log(JSON.stringify(values, null, 2));\n                  console.log(res);\n                  resetForm(true);\n                  setSubmitting(false);\n                }, 200);\n\n              case 5:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3);\n      }));\n\n      return function (_x3, _x4) {\n        return _ref5.apply(this, arguments);\n      };\n    }(),\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 5\n    }\n  }, function (_ref6) {\n    var isSubmitting = _ref6.isSubmitting;\n    return __jsx(MiniStyledPage, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 9\n      }\n    }, __jsx(\"h4\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 11\n      }\n    }, \"Correction Info Centre\"), __jsx(Error, {\n      error: errorMut,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 11\n      }\n    }), __jsx(StyledForm, {\n      disabled: isSubmitting || loadingMut,\n      \"aria-busy\": isSubmitting || loadingMut,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 11\n      }\n    }, __jsx(Form, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 13\n      }\n    }, __jsx(Controls, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 15\n      }\n    }, __jsx(SygexInput, {\n      id: \"centerName\",\n      name: \"centerName\",\n      type: \"text\",\n      label: \"Nom du centre\",\n      disabled: isSubmitting,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 17\n      }\n    }), __jsx(SygexInput, {\n      id: \"centerCode\",\n      name: \"centerCode\",\n      type: \"text\",\n      label: \"Code du centre\",\n      disabled: isSubmitting,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 17\n      }\n    }), __jsx(SygexInput, {\n      name: \"centerNumber\",\n      id: \"centerNumber\",\n      type: \"number\",\n      label: \"Num\\xE9ro du centre\",\n      disabled: isSubmitting,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 134,\n        columnNumber: 17\n      }\n    }), __jsx(ButtonStyled, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 142,\n        columnNumber: 17\n      }\n    }, __jsx(StyledButton, {\n      type: \"submit\",\n      disabled: isSubmitting,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 143,\n        columnNumber: 19\n      }\n    }, \"Valid\", isSubmitting ? \"ation en cours\" : \"er\"))))));\n  });\n};\n\n_s(UpdateCenter, \"GHtSdxIozx2JrAhXq5JMNd0M04g=\", false, function () {\n  return [useApolloClient, useForm, useMutation];\n});\n\n_c2 = UpdateCenter;\nexport default UpdateCenter;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"Controls\");\n$RefreshReg$(_c2, \"UpdateCenter\");","map":{"version":3,"sources":["E:/sygefexMui/sygefexMui-frontend/src/components/center/UpdateCenter.jsx"],"names":["React","useEffect","useMutation","useApolloClient","MiniStyledPage","Error","Formik","Form","useForm","Router","Yup","SygexInput","StyledForm","StyledButton","ButtonStyled","singleCenterQuery","updateCenterMutation","styled","Controls","div","UpdateCenter","id","client","centerCode","centerName","centerNumber","state","setState","useState","isOpen","message","type","notify","setNotify","handleChange","e","target","name","value","val","parseFloat","updateSingleCenter","updateMutation","preventDefault","variables","res","loadCenterData","query","error","data","centerData","center","console","log","initialValues","validationSchema","object","shape","string","required","number","updateCenter","loadingMut","loading","errorMut","values","resetForm","setSubmitting","setTimeout","JSON","stringify","isSubmitting"],"mappings":"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","sourcesContent":["\r\nimport React, { useEffect } from 'react';\r\nimport { useMutation, useApolloClient } from '@apollo/react-hooks'\r\nimport { MiniStyledPage } from '../styles/StyledPage'\r\nimport Error from '../ErrorMessage';\r\nimport { Formik, Form } from 'formik';\r\nimport useForm from '../utils/useForm'\r\nimport Router from 'next/router';\r\nimport * as Yup from 'yup';\r\nimport { SygexInput, StyledForm, StyledButton, ButtonStyled } from '../utils/FormInputs'\r\nimport { singleCenterQuery } from \"../queries&Mutations&Functions/Queries\";\r\nimport { updateCenterMutation } from \"../queries&Mutations&Functions/Mutations\";\r\n\r\nimport styled from 'styled-components'\r\n\r\n\r\nconst Controls = styled.div`\r\npadding:0 2rem;\r\n`;\r\nconst UpdateCenter = ({ id }) => {\r\n  const client = useApolloClient()\r\n  const [state, setState] = useForm({\r\n    centerCode: \"\",\r\n    centerName: \"\",\r\n    centerNumber: \"\",\r\n  })\r\n\r\n  \r\n  const [notify, setNotify] = useState({\r\n    isOpen: false,\r\n    message: \"\",\r\n    type: \"\",\r\n  });\r\n  const handleChange = e => {\r\n    const { name, value, type } = e.target;\r\n    const val = type === \"number\" ? parseFloat(value) : value;\r\n    setState({ [name]: val });\r\n  };\r\n\r\n  const updateSingleCenter = async (e, updateMutation) => {\r\n    e.preventDefault();\r\n    const res = await updateMutation({\r\n      variables: { id,  ...state}\r\n    });\r\n  };\r\n\r\n\r\n\r\n  const loadCenterData = async () => {\r\n    const { error, data } = await client.query({\r\n      query: singleCenterQuery,\r\n      variables: { id }\r\n    })\r\n    {error && <Error error={error}/>}\r\n    const centerData = { ...data.center }\r\n    const {\r\n      centerCode,\r\n      centerName,\r\n      centerNumber,\r\n    } = centerData\r\n    setState({\r\n      centerCode: centerCode,\r\n      centerName: centerName,\r\n      centerNumber: centerNumber,\r\n\r\n    })\r\n    console.log(centerData)\r\n  }\r\n\r\n\r\n  useEffect(() => {\r\n    loadCenterData()\r\n  }, [])\r\n\r\n  const initialValues = {\r\n    centerCode: \"\",\r\n    centerName: \"\",\r\n    centerNumber: \"\",\r\n  }\r\n\r\n  const validationSchema = Yup.object().shape({\r\n    centerName: Yup.string().required('Libellé du centre obligatoire'),\r\n    centerCode: Yup.string().required('Code du centre  obligatoire'),\r\n    centerNumber: Yup.number().required('Numéro  du centre obligatoire'),\r\n  });\r\n\r\n  const [updateCenter, { loading: loadingMut, error: errorMut }] = useMutation(updateCenterMutation, {\r\n    variables: { id }\r\n  })\r\n  return (\r\n    <Formik\r\n      method=\"POST\"\r\n      initialValues={state || initialValues}\r\n      enableReinitialize\r\n      validationSchema={validationSchema}\r\n      onSubmit={async (values, { resetForm, setSubmitting }) => {\r\n        const res = await updateCenter({\r\n          variables: { ...values, id },\r\n        });\r\n        \r\n        setTimeout(() => {\r\n          console.log(JSON.stringify(values, null, 2));\r\n          console.log(res);\r\n          resetForm(true);\r\n          setSubmitting(false);\r\n        }, 200);\r\n      }}\r\n\r\n    >\r\n      {({ isSubmitting }) => (\r\n\r\n        <MiniStyledPage>\r\n          <h4>Correction Info Centre</h4>\r\n          <Error error={errorMut} />\r\n          <StyledForm disabled={isSubmitting  ||loadingMut} aria-busy={isSubmitting  ||loadingMut} >\r\n            <Form>\r\n              <Controls>\r\n                <SygexInput\r\n                  id=\"centerName\"\r\n                  name=\"centerName\"\r\n                  type=\"text\"\r\n                  label=\"Nom du centre\"\r\n                  disabled={isSubmitting}\r\n\r\n                />\r\n                <SygexInput\r\n                  id=\"centerCode\"\r\n                  name=\"centerCode\"\r\n                  type=\"text\"\r\n                  label=\"Code du centre\"\r\n                  disabled={isSubmitting}\r\n\r\n                />\r\n                <SygexInput\r\n                  name=\"centerNumber\"\r\n                  id=\"centerNumber\"\r\n                  type=\"number\"\r\n                  label=\"Numéro du centre\"\r\n                  disabled={isSubmitting}\r\n                />\r\n\r\n                <ButtonStyled >\r\n                  <StyledButton type=\"submit\" disabled={isSubmitting}  >Valid{isSubmitting ? \"ation en cours\" : \"er\"}</StyledButton>\r\n                </ButtonStyled>\r\n              </Controls>\r\n            </Form>\r\n          </StyledForm>\r\n        </MiniStyledPage>\r\n      )\r\n      }\r\n    </Formik >\r\n\r\n  );\r\n}\r\n\r\nexport default UpdateCenter;\r\n"]},"metadata":{},"sourceType":"module"}